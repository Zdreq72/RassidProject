{% extends 'base.html' %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/airports.css' %}">

<div class="checkout-page-wrapper">
    <div class="checkout-card">

        <div class="checkout-icon-box">
            <span class="material-symbols-outlined checkout-icon">credit_card</span>
        </div>

        <h1 class="checkout-title">Complete Activation</h1>
        <p class="checkout-desc">
            You are one step away from activating the account for <strong>{{ request_obj.airport_name }}</strong>.
        </p>

        <div class="order-summary">
            <div class="summary-row">
                <span class="summary-label">Plan Selected</span>
                <span class="summary-value">{{ request_obj.get_selected_plan_display }}</span>
            </div>
            <div class="summary-total">
                <span class="summary-label">Total Amount</span>
                <span class="total-value">$499.00</span>
            </div>
        </div>

        <button id="checkout-button" class="pay-btn">
            <span class="material-symbols-outlined" style="font-size: 20px;">lock</span>
            Pay & Activate
        </button>
        <p class="security-note">
            <span class="material-symbols-outlined secure-icon">secure_check</span>
            Secure Payment via Stripe
        </p>

        <script src="https://js.stripe.com/v3/"></script>
        <script type="text/javascript">
            var stripe = Stripe('{{ stripe_public_key }}');
            var checkoutButton = document.getElementById('checkout-button');

            checkoutButton.addEventListener('click', function () {
                stripe.redirectToCheckout({
                    sessionId: '{{ session_id }}'
                }).then(function (result) {
                    if (result.error) {
                        alert(result.error.message);
                    }
                });
            });
        </script>

    </div>
</div>
{% endblock %}