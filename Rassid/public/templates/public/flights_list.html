{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="page-header">
    <div class="container">
        <h1>Live Flight Tracker</h1>
        <p>Real-time departure and arrival information</p>
    </div>
</div>

<div class="flights-container">
    <div class="flight-controls">
        <form method="GET" action="{% url 'public_flights_list' %}" class="search-box">
            <span class="material-symbols-outlined">search</span>
            <input type="text" name="search" value="{{ search_query|default:'' }}"
                placeholder="Search flight number, city or code...">
        </form>
    </div>

    <div class="flights-list">
        {% for flight in flights %}
        <div class="flight-card">
            <div class="fc-time">
                <span class="time">{{ flight.scheduledDeparture|date:"H:i" }}</span>
                <span class="date">{{ flight.scheduledDeparture|date:"M d" }}</span>
            </div>
            <div class="fc-info">
                <div class="route">
                    <span class="city">{{ flight.origin.city }} ({{ flight.origin.code }})</span>
                    <span class="material-symbols-outlined arrow">arrow_forward</span>
                    <span class="city">{{ flight.destination.city }} ({{ flight.destination.code }})</span>
                </div>
                <div class="details">
                    <span class="flight-no">{{ flight.flightNumber }}</span>
                    <span class="airline">{{ flight.airlineCode }}</span>
                </div>
            </div>
            <div class="fc-gate">
                <span class="label">Gate</span>
                {% with gate=flight.gateassignment_set.first %}
                <span class="value">
                    {% if gate %}{{ gate.gateCode }}{% else %}-{% endif %}
                </span>
                {% endwith %}
            </div>
            <div class="fc-status status-{{ flight.status|lower }}">
                {{ flight.status }}
            </div>
        </div>
        {% empty %}
        <div class="text-center" style="padding: 40px; color: #64748b;">
            <p>No active flights found.</p>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}